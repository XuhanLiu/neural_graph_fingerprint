# Comparing Similarity using NFP and CFP

Model was trained on 300k (80% train) MPro data, and tested on individually sampled 20k data.

* NFP length: 128 float16
* CFP length: 2048 bits
* TopK = 200.

Overall Performance (Higher the better)

| averages                 |       nfp |       cfp |
|--------------------------|-----------|-----------|
| avg top-200 score mean   | 7.86823   | 7.04068   |
| avg top-200 score recall | 0.0729545 | 0.0356818 |
| avg spearman corr.       | 0.331202  | 0.0556998 |

## Details

generate nfp cfp ../dataset/covid19/MPro_sample20k.csv ../output/MPro_mergedmulti_class.pkg 2048 200

compare cfp nfp ../dataset/covid19/MPro_sample20k.pkl

DEMO on the last target: Mpro-x1249

rho NFP: 0.19030260920740777, rho CFP: -0.005133554407242648

| smiles                                                                 |      nfp |   nfp rank |       cfp |   cfp rank |     scr |    Δscr |
|------------------------------------------------------------------------|----------|------------|-----------|------------|---------|-----------|
| O=C(O[C@@H]1Cc2c(O)cc(O)cc2O[C@@H]1c1cc(O)c(O)c(O)c1)c1cc(O)c(O)c(O)c1 | 1        |          0 | 1         |        0   | 11.6778 | 0         |
| NC(=O)Nc1ccc(S(=O)(=O)N2CCC(n3c(=O)[nH]c4ccccc43)CC2)cc1               | 0.665212 |       1634 | 0.0647059 |     9038   | 11.6167 | 0.0610867 |
| N#CCCN(Cc1cccnc1)C(=O)Cc1ccc(O)cc1Cl                                   | 0.57685  |       8323 | 0.0641026 |     9338   | 11.4413 | 0.236545  |
| Cc1ccc(C(=O)NC2(c3ccc(Cl)cc3)CCOCC2)cn1                                | 0.628456 |       3875 | 0.062069  |    10429.5 | 11.2364 | 0.441458  |
| O=c1[nH]ncc(NCC2(c3ccc4c(c3)OCO4)CCOCC2)c1Cl                           | 0.66329  |       1729 | 0.0670732 |     7795   | 11.234  | 0.443854  |
| Cc1ccncc1NC(=O)N[C@H]1CCO[C@@H]1c1c(C)nn(C)c1C                         | 0.602163 |       6029 | 0.0764331 |     3857.5 | 11.1976 | 0.480206  |
| Clc1ccc(Sc2c(-c3ccccc3)nc3ncccn23)cc1                                  | 0.662349 |       1765 | 0.04      |    18716.5 | 11.1603 | 0.51748   |
| Nc1nccnc1C(=O)NCC(c1ccccc1)c1c[nH]c2ccccc12                            | 0.772648 |         15 | 0.0361446 |    19286   | 11.1231 | 0.554667  |
| O=C(CSc1nnc(-c2ccncc2)o1)c1ccc2ccccc2c1                                | 0.574446 |       8574 | 0.060241  |    11337   | 11.0037 | 0.674077  |
| N#Cc1ccncc1NC1CCCN(c2ccccc2C(N)=O)C1                                   | 0.687582 |        820 | 0.0700637 |     6383.5 | 10.9939 | 0.683904  |
| COc1ccccc1CCC(=O)Nc1cccc2cn[nH]c12                                     | 0.579839 |       8037 | 0.0636943 |     9545   | 10.9225 | 0.755365  |
| Cc1nn(-c2ccccc2)c(C)c1CC(=O)NCc1ccc(S(N)(=O)=O)cc1                     | 0.604315 |       5824 | 0.0402299 |    18679   | 10.8852 | 0.792632  |
| O=C(CCCNC(=O)NC1CCCCC1)NC1CCCc2c1cnn2Cc1ccccc1                         | 0.598769 |       6295 | 0.0808081 |     2543   | 10.874  | 0.8038    |
| COC(=O)c1ccc(C(NC(=O)Nc2cc[nH]n2)C(F)(F)F)cc1                          | 0.604717 |       5786 | 0.0666667 |     7976.5 | 10.8158 | 0.861974  |
| N#CCCN(C(=O)CSc1nc2cc(Cl)cnc2[nH]1)c1cccc(Cl)c1                        | 0.600843 |       6142 | 0.0591716 |    11908   | 10.7875 | 0.890353  |
| Cc1[nH]c(=O)[nH]c(=O)c1CCC(=O)NC(Cc1ccccc1)c1ccccc1                    | 0.651414 |       2340 | 0.0490798 |    16371   | 10.7729 | 0.904928  |
| CN1C(=O)N[C@@H]2CN(c3nc4c(F)cccc4n3C)CC[C@@H]21                        | 0.634567 |       3422 | 0.0519481 |    15261.5 | 10.7529 | 0.924907  |
| Fc1cnc(NC[C@@H]2C[C@H](F)CN2Cc2cncnc2)nc1                              | 0.534461 |      12688 | 0.0457516 |    17390   | 10.7437 | 0.934118  |
| N[C@@H](c1ccccc1)c1ccc(-c2ncnc3[nH]cnc23)cc1                           | 0.608649 |       5465 | 0.0397351 |    18772   | 10.7214 | 0.956387  |
| O=C(Nc1cccnc1)C1(c2cccc(Br)c2)CCCC1                                    | 0.593596 |       6770 | 0.0714286 |     5768.5 | 10.6563 | 1.02149   |


| pocket     |   nfp avg |   cfp avg |   nfp rcl |   cfp rcl |     nfp ρ |       cfp ρ |
|------------|-----------|-----------|-----------|-----------|-----------|-------------|
| Mpro-x0072 |   8.62404 |   7.66949 |     0.075 |     0.02  | 0.384687  |  0.0134184  |
| Mpro-x0104 |   9.5155  |   8.35028 |     0.14  |     0.035 | 0.519793  |  0.105366   |
| Mpro-x0107 |   6.94782 |   6.78697 |     0.02  |     0.01  | 0.0497423 | -0.0139939  |
| Mpro-x0161 |   9.27136 |   6.97514 |     0.065 |     0.01  | 0.350931  | -0.0132363  |
| Mpro-x0195 |   8.10259 |   7.02502 |     0.12  |     0.025 | 0.450786  |  0.0929785  |
| Mpro-x0305 |   8.89014 |   8.56748 |     0.065 |     0.05  | 0.43599   |  0.0706412  |
| Mpro-x0354 |   8.44002 |   7.84554 |     0.055 |     0.02  | 0.282093  |  0.0801655  |
| Mpro-x0387 |   7.28733 |   6.56883 |     0.105 |     0.115 | 0.540061  |  0.0600063  |
| Mpro-x0395 |   7.55302 |   7.52073 |     0.04  |     0.045 | 0.239853  |  0.140108   |
| Mpro-x0397 |   6.46399 |   6.44589 |     0.015 |     0.04  | 0.3538    |  0.0107471  |
| Mpro-x0426 |   7.13906 |   5.94342 |     0.145 |     0.05  | 0.452282  |  0.10035    |
| Mpro-x0434 |   7.9951  |   7.69495 |     0.08  |     0.085 | 0.356279  |  0.125697   |
| Mpro-x0540 |   6.63938 |   5.40567 |     0.095 |     0.03  | 0.402017  |  0.0505142  |
| Mpro-x0678 |   8.72045 |   8.14742 |     0.075 |     0.045 | 0.359428  |  0.140795   |
| Mpro-x0874 |   8.16972 |   7.59143 |     0.06  |     0.025 | 0.330019  |  0.0306755  |
| Mpro-x0946 |   7.46292 |   6.10425 |     0.06  |     0.03  | 0.34061   |  0.00871811 |
| Mpro-x0967 |   8.44843 |   7.49769 |     0.045 |     0.01  | 0.275977  |  0.0831877  |
| Mpro-x0991 |   6.70257 |   6.65278 |     0.025 |     0.055 | 0.0548847 |  0.110272   |
| Mpro-x0995 |   7.29481 |   5.85884 |     0.145 |     0.035 | 0.415889  |  0.0609781  |
| Mpro-x1077 |   8.50751 |   7.25262 |     0.125 |     0.015 | 0.352613  | -0.0151412  |
| Mpro-x1093 |   7.0948  |   5.62793 |     0.025 |     0.025 | 0.148414  | -0.0117175  |
| Mpro-x1249 |   7.83039 |   7.36271 |     0.025 |     0.01  | 0.190303  | -0.00513355 |

