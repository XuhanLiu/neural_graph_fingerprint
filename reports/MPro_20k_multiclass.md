# Comparing Similarity using NFP and CFP
Model was trained on 50k sampled MPro data, and tested on individually sampled 20k data.

* NFP length: 128 float16
* CFP length: 2048 bits
* TopK = 200.

Overall Performance (Higher the better)

| averages                 |       nfp |       cfp |
|--------------------------|-----------|-----------|
| avg top-200 score mean   | 7.72578   | 7.04068   |
| avg top-200 score recall | 0.0688636 | 0.0356818 |
| avg spearman corr.       | 0.243402  | 0.0556998 |

## Details

generate nfp cfp ../dataset/covid19/MPro_sample20k.csv ../output/MPro_sample50kmulti_class.pkg 2048 200
compare cfp nfp ../dataset/covid19/MPro_sample20k.pkl

DEMO on the last target: Mpro-x1249
rho NFP: 0.3059906736872234, rho CFP: -0.005133554407242648

| smiles                                                                 |      nfp |   nfp rank |       cfp |   cfp rank |     scr |    |Δscr| |
|------------------------------------------------------------------------|----------|------------|-----------|------------|---------|-----------|
| O=C(O[C@@H]1Cc2c(O)cc(O)cc2O[C@@H]1c1cc(O)c(O)c(O)c1)c1cc(O)c(O)c(O)c1 | 1        |          0 | 1         |        0   | 11.6778 | 0         |
| NC(=O)Nc1ccc(S(=O)(=O)N2CCC(n3c(=O)[nH]c4ccccc43)CC2)cc1               | 0.55092  |        584 | 0.0647059 |     9038   | 11.6167 | 0.0610867 |
| N#CCCN(Cc1cccnc1)C(=O)Cc1ccc(O)cc1Cl                                   | 0.553785 |        526 | 0.0641026 |     9338   | 11.4413 | 0.236545  |
| Cc1ccc(C(=O)NC2(c3ccc(Cl)cc3)CCOCC2)cn1                                | 0.528325 |       1249 | 0.062069  |    10429.5 | 11.2364 | 0.441458  |
| O=c1[nH]ncc(NCC2(c3ccc4c(c3)OCO4)CCOCC2)c1Cl                           | 0.557253 |        464 | 0.0670732 |     7795   | 11.234  | 0.443854  |
| Cc1ccncc1NC(=O)N[C@H]1CCO[C@@H]1c1c(C)nn(C)c1C                         | 0.409078 |      12431 | 0.0764331 |     3857.5 | 11.1976 | 0.480206  |
| Clc1ccc(Sc2c(-c3ccccc3)nc3ncccn23)cc1                                  | 0.53558  |       1015 | 0.04      |    18716.5 | 11.1603 | 0.51748   |
| Nc1nccnc1C(=O)NCC(c1ccccc1)c1c[nH]c2ccccc12                            | 0.554903 |        503 | 0.0361446 |    19286   | 11.1231 | 0.554667  |
| O=C(CSc1nnc(-c2ccncc2)o1)c1ccc2ccccc2c1                                | 0.473959 |       5148 | 0.060241  |    11337   | 11.0037 | 0.674077  |
| N#Cc1ccncc1NC1CCCN(c2ccccc2C(N)=O)C1                                   | 0.566722 |        315 | 0.0700637 |     6383.5 | 10.9939 | 0.683904  |
| COc1ccccc1CCC(=O)Nc1cccc2cn[nH]c12                                     | 0.489871 |       3674 | 0.0636943 |     9545   | 10.9225 | 0.755365  |
| Cc1nn(-c2ccccc2)c(C)c1CC(=O)NCc1ccc(S(N)(=O)=O)cc1                     | 0.419731 |      11231 | 0.0402299 |    18679   | 10.8852 | 0.792632  |
| O=C(CCCNC(=O)NC1CCCCC1)NC1CCCc2c1cnn2Cc1ccccc1                         | 0.428588 |      10230 | 0.0808081 |     2543   | 10.874  | 0.8038    |
| COC(=O)c1ccc(C(NC(=O)Nc2cc[nH]n2)C(F)(F)F)cc1                          | 0.461399 |       6483 | 0.0666667 |     7976.5 | 10.8158 | 0.861974  |
| N#CCCN(C(=O)CSc1nc2cc(Cl)cnc2[nH]1)c1cccc(Cl)c1                        | 0.523072 |       1474 | 0.0591716 |    11908   | 10.7875 | 0.890353  |
| Cc1[nH]c(=O)[nH]c(=O)c1CCC(=O)NC(Cc1ccccc1)c1ccccc1                    | 0.501241 |       2789 | 0.0490798 |    16371   | 10.7729 | 0.904928  |
| CN1C(=O)N[C@@H]2CN(c3nc4c(F)cccc4n3C)CC[C@@H]21                        | 0.483601 |       4177 | 0.0519481 |    15261.5 | 10.7529 | 0.924907  |
| Fc1cnc(NC[C@@H]2C[C@H](F)CN2Cc2cncnc2)nc1                              | 0.376988 |      15510 | 0.0457516 |    17390   | 10.7437 | 0.934118  |
| N[C@@H](c1ccccc1)c1ccc(-c2ncnc3[nH]cnc23)cc1                           | 0.511833 |       2092 | 0.0397351 |    18772   | 10.7214 | 0.956387  |
| O=C(Nc1cccnc1)C1(c2cccc(Br)c2)CCCC1                                    | 0.510232 |       2193 | 0.0714286 |     5768.5 | 10.6563 | 1.02149   |



| pocket     |   nfp avg |   cfp avg |   nfp rcl |   cfp rcl |     nfp ρ |       cfp ρ |
|------------|-----------|-----------|-----------|-----------|-----------|-------------|
| Mpro-x0072 |   8.28711 |   7.66949 |     0.045 |     0.02  | 0.368046  |  0.0134184  |
| Mpro-x0104 |   9.31913 |   8.35028 |     0.1   |     0.035 | 0.434428  |  0.105366   |
| Mpro-x0107 |   7.14439 |   6.78697 |     0.035 |     0.01  | 0.203499  | -0.0139939  |
| Mpro-x0161 |   8.83423 |   6.97514 |     0.035 |     0.01  | 0.230154  | -0.0132363  |
| Mpro-x0195 |   8.34943 |   7.02502 |     0.095 |     0.025 | 0.333399  |  0.0929785  |
| Mpro-x0305 |   8.73893 |   8.56748 |     0.095 |     0.05  | 0.304137  |  0.0706412  |
| Mpro-x0354 |   8.37598 |   7.84554 |     0.065 |     0.02  | 0.277443  |  0.0801655  |
| Mpro-x0387 |   7.01559 |   6.56883 |     0.11  |     0.115 | 0.331753  |  0.0600063  |
| Mpro-x0395 |   7.56356 |   7.52073 |     0.075 |     0.045 | 0.189578  |  0.140108   |
| Mpro-x0397 |   6.5007  |   6.44589 |     0.045 |     0.04  | 0.0987668 |  0.0107471  |
| Mpro-x0426 |   6.87637 |   5.94342 |     0.095 |     0.05  | 0.264951  |  0.10035    |
| Mpro-x0434 |   7.92841 |   7.69495 |     0.095 |     0.085 | 0.269434  |  0.125697   |
| Mpro-x0540 |   6.49552 |   5.40567 |     0.075 |     0.03  | 0.187384  |  0.0505142  |
| Mpro-x0678 |   8.57201 |   8.14742 |     0.075 |     0.045 | 0.326301  |  0.140795   |
| Mpro-x0874 |   7.74345 |   7.59143 |     0.07  |     0.025 | 0.183485  |  0.0306755  |
| Mpro-x0946 |   7.28659 |   6.10425 |     0.07  |     0.03  | 0.201343  |  0.00871811 |
| Mpro-x0967 |   8.19321 |   7.49769 |     0.045 |     0.01  | 0.265483  |  0.0831877  |
| Mpro-x0991 |   6.92492 |   6.65278 |     0.035 |     0.055 | 0.132302  |  0.110272   |
| Mpro-x0995 |   7.0108  |   5.85884 |     0.095 |     0.035 | 0.232063  |  0.0609781  |
| Mpro-x1077 |   8.10857 |   7.25262 |     0.085 |     0.015 | 0.174843  | -0.0151412  |
| Mpro-x1093 |   6.72091 |   5.62793 |     0.035 |     0.025 | 0.0400666 | -0.0117175  |
| Mpro-x1249 |   7.97727 |   7.36271 |     0.04  |     0.01  | 0.305991  | -0.00513355 |

